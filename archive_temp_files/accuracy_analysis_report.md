# パチンコグラフ抽出精度の詳細分析レポート

## 1. 分析概要

advanced_method_accuracy_results.csvのデータ（14件）を分析し、3つの手法（従来手法、保守的SP法、高度な手法）の誤差パターンと特徴を調査しました。

## 2. 主要な発見

### 2.1 誤差の符号（プラス/マイナス）の傾向

すべての手法で**過小評価の傾向**（マイナス誤差が多い）が確認されました：

- **従来手法**: マイナス誤差 71.4%、プラス誤差 28.6%
- **保守的SP法**: マイナス誤差 71.4%、プラス誤差 28.6%
- **高度な手法**: マイナス誤差 64.3%、プラス誤差 35.7%

**平均誤差**：
- 従来手法: -131.9
- 保守的SP法: -289.1（最も過小評価）
- 高度な手法: -161.7

### 2.2 系統的バイアスの検定結果

統計的検定（t検定）により：
- **従来手法**: 有意なバイアスなし（p=0.1164）
- **保守的SP法**: 有意なバイアスなし（p=0.0665）
- **高度な手法**: **有意な過小評価バイアスあり**（p=0.0327）

### 2.3 手法間の相関

各手法の誤差には強い相関があります：
- 従来手法 vs 保守的SP: 0.913
- 従来手法 vs 高度な手法: 0.918
- 保守的SP vs 高度な手法: 0.732

これは、同じ画像で誤差が生じやすい共通の要因があることを示唆しています。

### 2.4 極端な誤差のケース

**特に誤差が大きい画像**：
- **画像番号78209170（台番号467）**: 実際195、推定-672〜-1833（誤差-561.6〜-2028）
  - 実際の最大値が17と極端に小さい
  - グラフの振れ幅が小さく、検出が困難な可能性

- **画像番号78209158（台番号458）**: 実際-19100、推定約-19500（誤差約-400〜-500）
  - 大きなマイナス値での誤差

- **画像番号78209168（台番号466）**: 実際-24750、推定約-25100（誤差約-360〜-420）
  - 極端なマイナス値での誤差

### 2.5 高度な手法の改善効果

- 改善したケース: 35.7%
- 悪化したケース: 50.0%
- 平均改善値: 100.8（ただし中央値は-12.2）

高度な手法は必ずしも改善をもたらしていません。

## 3. 誤差パターンの特徴

### 3.1 値の範囲別の傾向

最終差玉の範囲別に見ると：
- **極端な値**（±20000以上）で誤差が大きくなる傾向
- **中間的な値**（0〜10000）では比較的誤差が小さい
- **マイナス領域**での過小評価が顕著

### 3.2 最大値との関係

実際の最大値が極端に小さい（17など）場合、すべての手法で大きな誤差が発生しています。

## 4. 精度向上のための具体的な改善案

### 4.1 過小評価バイアスの補正
- すべての手法で系統的な過小評価傾向があるため、キャリブレーション係数の導入
- 推定値に対して1.05〜1.10程度の補正係数を適用

### 4.2 極端な値への対応
- 値が±20000を超える範囲では別の検出アルゴリズムを適用
- グラフの振れ幅が小さい場合（最大値<1000）の特別な処理

### 4.3 適応的な手法選択
- 画像の特徴（振れ幅、ノイズレベル、値の範囲）に基づいて最適な手法を選択
- 例：振れ幅が大きい場合は従来手法、小さい場合は保守的SP法

### 4.4 複数手法のアンサンブル
- 3つの手法の加重平均を使用
- 各手法の信頼度に基づいて重みを動的に調整

### 4.5 エラー検出と再処理
- 推定値が物理的に不可能な範囲（例：最大値を超える最終値）の場合、自動的に再処理
- 複数手法の結果が大きく乖離する場合の警告システム

### 4.6 学習ベースの補正
- 実際の値と推定値のペアを使用して、機械学習モデルで補正関数を学習
- 画像特徴量（コントラスト、ノイズレベル、グラフの密度など）を入力として使用

### 4.7 前処理の改善
- グラフ領域の検出精度向上
- ノイズ除去とエッジ強調の最適化
- 色空間変換の改良（HSV以外の色空間の検討）

これらの改善により、特に極端な値や小さな振れ幅のグラフでの精度向上が期待できます。